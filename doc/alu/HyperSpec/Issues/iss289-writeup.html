<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<!-- Common Lisp HyperSpec (TM), version 3.0 generated by kmp on Thu, 2-May-1996 10:21am EDT -->
<HTML>
<HEAD>
<TITLE>CLHS: Issue READER-ERROR Writeup</TITLE>
<META HTTP-EQUIV="Author" CONTENT="Kent M. Pitman">
<META HTTP-EQUIV="Organization" CONTENT="The Harlequin Group Limited">
<LINK REL=TOP HREF="../FrontMatter/index.html">
<LINK REL=COPYRIGHT HREF="../FrontMatter/About-HyperSpec.html#Legal">
<LINK REL=DISCLAIMER HREF="../FrontMatter/About-HyperSpec.html#Disclaimer">
<LINK REL=PREV HREF="../Issues/iss288-writeup.html">
<LINK REL=UP HREF="../Issues/iss289.html">
<LINK REL=NEXT HREF="../Issues/iss290-writeup.html">
</HEAD>
<BODY BGCOLOR="#c0c0c0">
<H1><A REV=MADE HREF="http://www.harlequin.com/"><IMG ALT="[HARLEQUIN]" SRC="../Graphics/Harlequin-Small.gif" ALIGN=Bottom></A><A REL=TOP HREF="../FrontMatter/index.html"><IMG ALT="[Common Lisp HyperSpec (TM)]" SRC="../Graphics/HyperSpec-Small.gif" ALIGN=Bottom></A> <A REL=PREV HREF="../Issues/iss288-writeup.html"><IMG ALT="[Previous]" SRC="../Graphics/Prev.gif" ALIGN=Bottom></A><A REL=UP HREF="../Issues/iss289.html"><IMG ALT="[Up]" SRC="../Graphics/Up.gif" ALIGN=Bottom></A><A REL=NEXT HREF="../Issues/iss290-writeup.html"><IMG ALT="[Next]" SRC="../Graphics/Next.gif" ALIGN=Bottom></A></H1>

<HR>



<H2>Issue READER-ERROR Writeup</H2>

<PRE><B>Forum:</B>		Cleanup<P>
<B>Issue:</B>		<A REL=DEFINITION HREF="../Body/contyp_reader-error.html#reader-error"><B>READER-ERROR</B></A><P>
<B>References:</B>	Chapter 3, &quot;Syntax&quot;<P>
		Section 2.2, &quot;Types&quot;<P>
<B>Category:</B>	ADDITION, CHANGE<P>
<B>Edit History:</B>   V1, 23 Oct 1989, Sandra Loosemore<P>
		V2, 02 Nov 1989, Sandra Loosemore<P>
			(change supertypes, update discussion)<P>
                V3, 10 Jul 1990, David Moon (include amendment from meeting)<P>
<P>
<P>
<B>Problem Description:<P>
</B><P>
Chapter 3 of the current draft is not consistent about the types of<P>
errors that must be signalled by the reader.  In most places where it<P>
specifies that an error is to be signalled, it does not indicate a<P>
particular type of error, but in at least one situation it requires<P>
the error to be of type <A REL=DEFINITION HREF="../Body/contyp_program-error.html#program-error"><B>PROGRAM-ERROR</B></A>, and in other cases it requires<P>
the error to be of type <A REL=DEFINITION HREF="../Body/any_error.html#error"><B>ERROR</B></A>.<P>
<P>
None of the <A REL=DEFINITION HREF="../Body/any_error.html#error"><B>ERROR</B></A> subtypes described in section 2.2 really seem<P>
appropriate for syntactic errors detected by the reader.  In<P>
particular, the description of <A REL=DEFINITION HREF="../Body/contyp_program-error.html#program-error"><B>PROGRAM-ERROR</B></A> implies that its purpose<P>
is for errors relating to program syntax which are detectable during<P>
evaluation or compilation rather than read-time errors.  It seems<P>
especially inappropriate to use <A REL=DEFINITION HREF="../Body/contyp_program-error.html#program-error"><B>PROGRAM-ERROR</B></A> for this purpose since<P>
the reader can be used to read things other than programs.  Likewise,<P>
<A REL=DEFINITION HREF="../Body/contyp_stream-error.html#stream-error"><B>STREAM-ERROR</B></A> appears to have been intended to be used for errors<P>
relating to character-level transactions on the stream rather than<P>
lexical analysis or parsing.<P>
<P>
<P>
<B>Proposal (READER-ERROR:NEW-TYPE):<P>
</B><P>
Add a new type specifier, <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A>.  This is a subtype of the<P>
types <A REL=DEFINITION HREF="../Body/contyp_stream-error.html#stream-error"><B>STREAM-ERROR</B></A>, <A REL=DEFINITION HREF="../Body/any_error.html#error"><B>ERROR</B></A>, <A REL=DEFINITION HREF="../Body/contyp_serious-condition.html#serious-condition"><B>SERIOUS-CONDITION</B></A>, <A REL=DEFINITION HREF="../Body/contyp_condition.html#condition"><B>CONDITION</B></A>, and T.  The<P>
type <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A> consists of serious conditions that relate to<P>
lexical analysis (the building and interpretation of tokens) and<P>
parsing (errors in reader macro syntax) by the Lisp reader.<P>
<P>
Since <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A> is a subtype of <A REL=DEFINITION HREF="../Body/contyp_stream-error.html#stream-error"><B>STREAM-ERROR</B></A>, objects of this type<P>
inherit a <A REL=DEFINITION HREF="../Body/syscla_stream.html#stream"><B>STREAM</B></A> slot, which can be accessed using the function<P>
<A REL=DEFINITION HREF="../Body/fun_stream-error-stream.html#stream-error-stream"><B>STREAM-ERROR-STREAM</B></A>.<P>
<P>
Change the discussion in chapter 3 to specify that the type of errors<P>
signalled by the reader is <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A>.  There are numerous places<P>
that would be affected.<P>
<P>
<P>
<B>Rationale:<P>
</B><P>
The general policy that has been followed in other areas of the<P>
language where errors must, should, or might be signalled is to<P>
specify a particular subtype of <A REL=DEFINITION HREF="../Body/any_error.html#error"><B>ERROR</B></A> which covers that <A REL=DEFINITION HREF="../Body/syscla_class.html#class"><B>class</B></A> of<P>
errors.  Doing the same for reader errors would be consistent with the<P>
overall policy, but none of the existing error types seem appropriate<P>
for reader-related errors.<P>
<P>
<P>
<B>Current Practice:<P>
</B><P>
LispWorks (from Harlequin) reportedly already uses such a condition.<P>
<P>
<P>
<B>Cost to implementors:<P>
</B><P>
Trivial.<P>
<P>
<P>
<B>Cost to users:<P>
</B><P>
Probably no user programs rely on the reader signalling any particular<P>
type of error yet.<P>
<P>
<P>
<B>Benefits:<P>
</B><P>
Increased consistency in the language design.<P>
Ability to set up handlers specifically for reader errors.<P>
<P>
<P>
<B>Discussion:<P>
</B><P>
Pitman says:<P>
  Our later comments will show that i would like this condition to be<P>
  called <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A> so that it doesn't seem to be useful only for <P>
  READ-related problems but can in fact be used for other parser-style<P>
  applications (e.g., a FORTRAN parser, a user-written English-language<P>
  interface, etc.).<P>
<P>
The initial version of this proposal specified that <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A> was<P>
disjoint from (rather than a subtype of) <A REL=DEFINITION HREF="../Body/contyp_stream-error.html#stream-error"><B>STREAM-ERROR</B></A>.  This was<P>
changed because there was a suggestion that some conditions should be<P>
both a <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A> and a <A REL=DEFINITION HREF="../Body/contyp_stream-error.html#stream-error"><B>STREAM-ERROR</B></A>.  Making it a subtype also allows<P>
it to inherit the <A REL=DEFINITION HREF="../Body/syscla_stream.html#stream"><B>STREAM</B></A> slot and the <A REL=DEFINITION HREF="../Body/fun_stream-error-stream.html#stream-error-stream"><B>STREAM-ERROR-STREAM</B></A> accessor.<P>
<P>
Prior to version 3 the condition <A REL=DEFINITION HREF="../Body/contyp_parse-error.html#parse-error"><B>PARSE-ERROR</B></A> was named <A REL=DEFINITION HREF="../Body/contyp_reader-error.html#reader-error"><B>READER-ERROR</B></A>.<P>
</PRE>

<HR>

<A REL=NAVIGATOR HREF="../FrontMatter/Starting-Points.html"><IMG ALT="[Starting Points]" SRC="../Graphics/Starting-Points.gif" ALIGN=Bottom></A><A REL=TOC HREF="../FrontMatter/Chapter-Index.html"><IMG ALT="[Contents]" SRC="../Graphics/Contents.gif" ALIGN=Bottom></A><A REL=INDEX HREF="../FrontMatter/Master-Index.html"><IMG ALT="[Index]" SRC="../Graphics/Index.gif" ALIGN=Bottom></A><A REL=INDEX HREF="../FrontMatter/Symbol-Index.html"><IMG ALT="[Symbols]" SRC="../Graphics/Symbols.gif" ALIGN=Bottom></A><A REL=GLOSSARY HREF="../Body/sec_26-1.html"><IMG ALT="[Glossary]" SRC="../Graphics/Glossary.gif" ALIGN=Bottom></A><A HREF="../Issues/Issues-Categorized.html"><IMG ALT="[Issues]" SRC="../Graphics/Issues.gif" ALIGN=Bottom></A><BR>

<A REL=COPYRIGHT HREF="../FrontMatter/About-HyperSpec.html#Legal"><I>Copyright 1996, The Harlequin Group Limited.  All Rights Reserved.</I></A><P>
</BODY>
</HTML>
